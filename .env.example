# ============================================
# PLANE v1.2.1 CONFIGURATION FOR DOKPLOY
# ============================================
# Copy this file to .env and fill in your values
# cp .env.example .env

# --- Application Settings ---
APP_RELEASE=v1.2.1
APP_DOMAIN=your-domain.com
WEB_URL=https://${APP_DOMAIN}
DEBUG=0

# --- Replicas (Swarm scaling) ---
WEB_REPLICAS=1
SPACE_REPLICAS=1
ADMIN_REPLICAS=1
API_REPLICAS=1
WORKER_REPLICAS=1
BEAT_WORKER_REPLICAS=1
LIVE_REPLICAS=1

# --- Security ---
# Generate with: openssl rand -base64 48
SECRET_KEY=CHANGE_ME_GENERATE_RANDOM_STRING
CORS_ALLOWED_ORIGINS=https://${APP_DOMAIN}

# --- Live Server ---
# Generate with: openssl rand -base64 24
LIVE_SERVER_SECRET_KEY=CHANGE_ME_GENERATE_RANDOM_STRING

# ============================================
# DATABASE (PostgreSQL)
# ============================================
# IMPORTANT: In Dokploy Stack, service names have prefix.
# Use format: <stack-name>_plane-db
# Example: plane-stack-abc123_plane-db
PGHOST=<stack-name>_plane-db
PGDATABASE=plane
POSTGRES_USER=plane
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
POSTGRES_DB=plane
POSTGRES_PORT=5432
PGDATA=/var/lib/postgresql/data
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@<stack-name>_plane-db/plane

# ============================================
# REDIS (Valkey)
# ============================================
# IMPORTANT: Use stack prefix, example: plane-stack-abc123_plane-redis
REDIS_HOST=<stack-name>_plane-redis
REDIS_PORT=6379
REDIS_URL=redis://<stack-name>_plane-redis:6379/

# ============================================
# MESSAGE QUEUE (RabbitMQ)
# ============================================
# IMPORTANT: Use stack prefix, example: plane-stack-abc123_plane-mq
RABBITMQ_HOST=<stack-name>_plane-mq
RABBITMQ_PORT=5672
RABBITMQ_USER=plane
RABBITMQ_PASSWORD=CHANGE_ME_STRONG_PASSWORD
RABBITMQ_VHOST=plane
AMQP_URL=amqp://${RABBITMQ_USER}:${RABBITMQ_PASSWORD}@<stack-name>_plane-mq:5672/plane

# ============================================
# OBJECT STORAGE (S3-Compatible)
# ============================================
# Supported: Yandex Cloud S3, AWS S3, MinIO, etc.
#
# --- Yandex Cloud S3 Example ---
# 1. Create bucket in Yandex Cloud Object Storage
# 2. Create service account with storage.editor role
# 3. Create static access key for the service account
# Docs: https://yandex.cloud/ru/docs/storage/tools/boto
#
USE_MINIO=0
AWS_REGION=ru-central1
AWS_ACCESS_KEY_ID=YOUR_YANDEX_ACCESS_KEY_ID
AWS_SECRET_ACCESS_KEY=YOUR_YANDEX_SECRET_ACCESS_KEY
AWS_S3_ENDPOINT_URL=https://storage.yandexcloud.net
AWS_S3_BUCKET_NAME=your-bucket-name
FILE_SIZE_LIMIT=5242880
MINIO_ENDPOINT_SSL=1

# --- MinIO Example (self-hosted) ---
# USE_MINIO=1
# AWS_REGION=
# AWS_ACCESS_KEY_ID=minio-access-key
# AWS_SECRET_ACCESS_KEY=minio-secret-key
# AWS_S3_ENDPOINT_URL=http://<stack-name>_plane-minio:9000
# AWS_S3_BUCKET_NAME=uploads
# MINIO_ENDPOINT_SSL=0

# ============================================
# API SETTINGS
# ============================================
# IMPORTANT: Use stack prefix, example: plane-stack-abc123_api
API_BASE_URL=http://<stack-name>_api:8000
GUNICORN_WORKERS=1
API_KEY_RATE_LIMIT=60/minute

# ============================================
# PROXY SETTINGS
# ============================================
# SSL terminated by Dokploy/Traefik - no need to configure SSL here
SITE_ADDRESS=:80

# ============================================
# MCP SERVER (Plane API for AI) - Optional
# ============================================
# Get API key from Plane: Profile -> Settings -> API Tokens
# Uncomment plane-mcp service in docker-compose.yml to enable
PLANE_API_KEY=
PLANE_WORKSPACE_SLUG=
MCP_PORT=8001
